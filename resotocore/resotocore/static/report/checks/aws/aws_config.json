{
    "provider": "aws",
    "service": "config",
    "checks": [
        {
            "name": "enabled_in_all_regions",
            "title": "Ensure AWS Config is enabled in all regions.",
            "result_kinds": ["aws_region"],
            "categories": ["security", "compliance"],
            "risk": "The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking and compliance auditing.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_region) with(empty, --> is(aws_config_recorder) and recorder_status.recording=true and recorder_group.all_supported=true and recorder_status.last_status=SUCCESS)"
            },
            "remediation": {
                "text": "It is recommended to enable AWS Config be enabled in all regions.",
                "url": "https://aws.amazon.com/blogs/mt/aws-config-best-practices/"
            }
        },
        {
            "name": "remediation_enabled",
            "title": "Ensure AWS Config remediation is enabled",
            "result_kinds": ["aws_region"],
            "categories": ["security", "compliance"],
            "risk": "AWS Config configurations to be implemented with remediation (Manual or automatic through System Manager",
            "severity": "medium",
            "detect": {
                "manual": "AWS Config allows you to remediate noncompliance resources that are evaluated by AWS Config Rules. AWS Config applies remediation using AWS Systems Manager Automation documents. These documents define the actions to be performed on non-compliant AWS resources evaluated by AWS Config Rules."
            },
            "remediation": {
                "text": "Configuration can be made to remediate manually with user defined reviews or automatically",
                "url": "https://docs.aws.amazon.com/config/latest/developerguide/remediation.html#setup-manualremediation"
            }
        }
    ]
}
