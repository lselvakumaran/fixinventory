{
    "provider": "aws",
    "service": "cloudfront",
    "checks": [
        {
            "name": "distribution_logging_enabled",
            "title": "Ensure that logging is enabled for every cloudfront distribution",
            "result_kinds": ["aws_cloudfront_distribution"],
            "categories": [ "security", "compliance" ],
            "risk": "Logging needs to be enabled to have visibility into access patterns, detect and investigate potential security threats, and comply with security best practices and regulatory requirements.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_cloudfront_distribution) and distribution_config.logging==null"
            },
            "remediation": {
                "text": "in addition to the CLI, you can also remediate via the management console",
                "url": "https://repost.aws/knowledge-center/cloudfront-logging-requests",
                "action": {
                    "aws_cli": "aws cloudfront update-distribution --id YOUR_DISTRIBUTION_ID --logging-config '{\"enabled\":true,\"bucket\":\"YOUR_S3_BUCKET\",\"prefix\":\"LOG_PREFIX\"}'"
                }
            }
        },
        {
            "name": "distribution_waf_enabled",
            "title": "Ensure that there is a Web Application Firewall associated with Cloudfront Distribution",
            "result_kinds": ["aws_cloudfront_distribution"],
            "categories": [ "security", "compliance" ],
            "risk": "WAF provide an additional layer of security and not having them associated can leave your distributions open to attacks from the internet such as DDoS",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_cloudfront_distribution) and distribution_config.web_acl_id in [null, \"\"]"
            },
            "remediation": {
                "text": "Associate your CloudFront Distributions with a Web ACL.",
                "url": "https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html"
            }
        }
    ]
}
