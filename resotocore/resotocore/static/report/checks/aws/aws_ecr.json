{
    "provider": "aws",
    "service": "ecr",
    "checks": [
        {
            "name": "image_scan_on_push",
            "title": "Check if ECR image scan on push is enabled.",
            "result_kind": "aws_ecr_repository",
            "categories": [],
            "risk": "Amazon ECR image scanning helps in identifying software vulnerabilities in your container images. Amazon ECR uses the Common Vulnerabilities and Exposures (CVEs) database from the open-source Clair project and provides a list of scan findings. ",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_ecr_repository) and image_scan_on_push = false"
            },
            "remediation": {
                "text": "Enable ECR image scanning and review the scan findings for information about the security of the container images that are being deployed.",
                "url": "https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html"
            }
        }
    ]
}
