{
    "provider": "aws",
    "service": "sns",
    "checks": [
        {
            "name": "encryption_at_rest_enabled",
            "title": "Ensure that Amazon SNS topics are encrypted at rest using KMS CMKs",
            "result_kinds": [ "aws_eks_cluster" ],
            "categories": [ "security", "compliance" ],
            "risk": "If not enabled sensitive information at rest is not protected.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_sns_topic) with(empty, --> is(aws_kms_key))"
            },
            "remediation": {
                "text": "Enable Encryption. Use a CMK where possible. It will provide additional management and privacy benefits",
                "url": "https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html"
            }
        }
    ]
}
