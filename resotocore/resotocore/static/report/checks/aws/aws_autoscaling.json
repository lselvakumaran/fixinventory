{
    "provider": "aws",
    "service": "autoscaling",
    "checks": [
        {
            "name": "launch_template_public_ip_disabled",
            "title": "Verify Auto Scaling Launch Templates Do Not Auto-Assign Public IP Addresses",
            "result_kinds": ["aws_autoscaling_group"],
            "categories": ["security", "compliance"],
            "risk": "Auto-assigning public IP addresses in Auto Scaling launch templates can lead to unintended public exposure of EC2 instances. This exposure increases the risk of malicious activities such as brute force attacks, data breaches, or unauthorized access, potentially compromising instance security and data integrity.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_autoscaling_group) with (any, --> is(aws_ec2_launch_template) and launch_template_data.network_interfaces[*].associate_public_ip_address==true)"
            },
            "remediation": {
                "text": "Modify the Auto Scaling launch template to disable automatic public IP association. Set 'AssociatePublicIpAddress' to false for all network interfaces in the launch template. Ensure instances are launched in private subnets if public access is not required.",
                "url": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-launch-templates.html#launch-template-network"
            }
        }
    ]
}

