{
    "provider": "aws",
    "service": "dynamodb",
    "checks": [
        {
            "name": "table_kms_encryption_enabled",
            "title": "Ensure DynamoDB table has encryption at rest enabled using CMK KMS.",
            "result_kinds": ["aws_region"],
            "categories": ["security", "compliance"],
            "risk": "All user data stored in Amazon DynamoDB is fully encrypted at rest. This functionality helps reduce the operational burden and complexity involved in protecting sensitive data.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_dynamo_db_table) and dynamodb_sse_description.sse_type!=KMS"
            },
            "remediation": {
                "text": "Specify an encryption key when you create a new table or switch the encryption keys on an existing table by using the AWS Management Console.",
                "url": "https://docs.aws.amazon.com/amazondynamodbdb/latest/developerguide/EncryptionAtRest.html"
            }
        }
    ]
}
