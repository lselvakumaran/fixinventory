{
    "provider": "aws",
    "service": "redshift",
    "checks": [
        {
            "name": "cluster_audit_logging_enabled",
            "title": "Ensure that cluster audit logging is enabled to aide in compliance and incident investigation",
            "result_kinds": [ "aws_redshift_cluster" ],
            "categories": [ "security", "compliance" ],
            "risk": "Enabling cluster audit logging in Amazon Redshift enhances security by providing detailed records of database activities, aiding in monitoring, incident investigation, and compliance.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_redshift_cluster) and redshift_logging_status.logging_enabled=false"
            },
            "remediation": {
                "text": "In the 'Cluster details' tab -> click 'Modify' Under 'Audit logging' -> enable or modify the settings -> Save the changes.",
                "url": "https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing-console.html"
            }
        },
        {
            "name": "cluster_publicly_accessible",
            "title": "Ensure that Redshift clusters are not publicly Accessible.",
            "result_kinds": [ "aws_redshift_cluster" ],
            "categories": [ "security", "compliance" ],
            "risk": "Publicly accessible services could expose sensitive data to bad actors.",
            "severity": "high",
            "detect": {
                "resoto": "is(aws_redshift_cluster) and redshift_publicly_accessible=true and redshift_endpoint.address!=null"
            },
            "remediation": {
                "text": "List all shared Redshift clusters and make sure there is a business reason for them.",
                "url": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html"
            }
        },
        {
            "name": "version_upgrade_enabled",
            "title": "Ensure that Redshift clusters are upgraded automatically.",
            "result_kinds": [ "aws_redshift_cluster" ],
            "categories": [ "security", "compliance" ],
            "risk": "When automatic upgrades are disabled, Redshift clusters may not be patched for security vulnerabilities.",
            "severity": "high",
            "detect": {
                "resoto": "is(aws_redshift_cluster) and redshift_allow_version_upgrade=false"
            },
            "remediation": {
                "text": "Enable automatic upgrades for all Redshift clusters.",
                "url": "https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html"
            }
        }

    ]
}
