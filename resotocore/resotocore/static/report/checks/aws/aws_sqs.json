{
    "provider": "aws",
    "service": "sqs",
    "checks": [
        {
            "name": "server_side_encryption_enabled",
            "title": "Ensure that Server-Side Encryption is Enabled for SQS Queues",
            "result_kinds": ["aws_sqs_queue"],
            "categories": ["security", "compliance"],
            "risk": "If server-side encryption is not enabled for SQS queues, sensitive information in transit could be compromised. This leads to risks of data leakage, breach of compliance regulations, and potential damage to the organization's reputation.",
            "severity": "medium",
            "detect": {
                "resoto": "is(aws_sqs_queue) and sqs_kms_master_key_id==null"
            },
            "remediation": {
                "text": "To mitigate this risk, ensure server-side encryption is turned on for all Amazon SQS queues. If possible, leverage a Customer Master Key (CMK) for enhanced management and privacy benefits.",
                "url": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html"
            },
            "url": "https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html"
        }
    ]
}
